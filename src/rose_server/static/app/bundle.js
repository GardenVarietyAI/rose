(()=>{var $=()=>({disabled:!1,label:"Ask",async ask(){let t=this.$el.closest("form")?.querySelector('[name="q"]:not([disabled])')?.value?.trim()||"";if(!(!t||this.disabled)){this.disabled=!0;try{let r=this.$el.closest("form")?.querySelector('select[name="lens_id"]')?.value?.trim()||"",a=await(await fetch("/v1/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t,lens_id:r||void 0})})).json();if(!a?.thread_id)throw new Error("Missing thread_id");let l=r?`?lens_id=${encodeURIComponent(r)}`:"";window.location.href="/v1/threads/"+a.thread_id+l}catch(e){alert("Error: "+(e?.message||String(e)))}finally{this.disabled=!1}}}});var M=()=>({uuid:null,accepted:!1,collapsed:!1,expanded:!1,editing:!1,draft:"",original:"",editable:!1,saving:!1,init(){this.uuid=this.$el.dataset.uuid,this.accepted=this.$el.classList.contains("accepted");let t=this.$refs?.sourceContent;if(this.editable=!!t,!this.editable)return;let e=t.content?.textContent;this.original=(e??this.$el.querySelector(".message-content")?.innerText??"").trimEnd(),this.draft=this.original},startEdit(){this.editable&&(this.editing=!0,this.draft=this.original,this.$nextTick(()=>this.$refs?.editor?.focus()))},cancelEdit(){this.editable&&(this.editing=!1,this.draft=this.original)},async saveEdit(){if(!(!this.editable||this.saving)){this.saving=!0;try{let t=await fetch(`/v1/messages/${this.uuid}/revisions`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({content:this.draft})});if(!t.ok)throw new Error(`HTTP ${t.status}`);window.location.reload()}catch(t){console.error("Error:",t),this.saving=!1}}},async toggleAccepted(){try{let t=await fetch(`/v1/messages/${this.uuid}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({accepted:!this.accepted})});if(!t.ok)throw new Error(`HTTP ${t.status}`);this.accepted=!this.accepted}catch(t){console.error("Error:",t)}}});function I(t){let e=[];for(let n of t)if(n.type==="text")if(e.length>0&&e[e.length-1].type==="text"){let r=e[e.length-1];r.value+=n.value}else e.push({type:"text",value:n.value});else e.push(n);return(e.length===0||e[e.length-1].type!=="text")&&e.push({type:"text",value:""}),e}function P(t){let e=[];for(let n of t)n.type==="text"&&n.value&&e.push(n.value);return e.join("")}function A(t,e=[]){let n=[];for(let r of e)n.push({type:"lens",lensId:r.lensId,atName:r.atName});return t&&n.push({type:"text",value:t}),I(n)}function N(t,e){let n=Math.max(0,Math.min(e.tokenIndex,t.length-1)),r=t[n],s=r.type==="text"?r.value.length:0,a=Math.max(0,Math.min(e.offset,s));return{tokenIndex:n,offset:a}}function _(t,e){let{tokens:n,caret:r}=t;if(e.type==="insertText"){let{at:s,text:a}=e,l=[...n],u=l[s.tokenIndex];if(u.type!=="text")throw new Error("Cannot insert text into non-text token");let m=u.value.slice(0,s.offset),o=u.value.slice(s.offset);l[s.tokenIndex]={type:"text",value:m+a+o};let i=I(l),f={tokenIndex:s.tokenIndex,offset:s.offset+a.length},p=N(i,f),x={type:"deleteRange",from:s,to:{tokenIndex:s.tokenIndex,offset:s.offset+a.length}};return{buffer:{tokens:i,caret:p},inverse:x}}if(e.type==="deleteRange"){let{from:s,to:a}=e,l=[...n],u=[];if(s.tokenIndex===a.tokenIndex){let d=l[s.tokenIndex];if(d.type!=="text")throw new Error("Cannot delete from non-text token");let g=d.value.slice(0,s.offset),k=d.value.slice(s.offset,a.offset),w=d.value.slice(a.offset);l[s.tokenIndex]={type:"text",value:g+w};let O=I(l),T={tokenIndex:s.tokenIndex,offset:s.offset},S=N(O,T);return{buffer:{tokens:O,caret:S},inverse:{type:"insertText",at:s,text:k}}}let m=l[s.tokenIndex],o=l[a.tokenIndex];if(m.type!=="text"||o.type!=="text")throw new Error("Cross-token delete requires text tokens at boundaries");let i=m.value.slice(0,s.offset),f=m.value.slice(s.offset),p=o.value.slice(0,a.offset),x=o.value.slice(a.offset);for(let d=s.tokenIndex;d<=a.tokenIndex;d++)u.push(l[d]);u[0]={type:"text",value:f},u[u.length-1]={type:"text",value:p};let h=[];for(let d=0;d<u.length;d++){let g=u[d];if(g.type==="text")if(h.length>0&&h[h.length-1].type==="text"){let k=h[h.length-1];h[h.length-1]={type:"text",value:k.value+g.value}}else h.push(g);else h.push(g)}for(let d=a.tokenIndex;d>=s.tokenIndex;d--)l.splice(d,1);l.splice(s.tokenIndex,0,{type:"text",value:i+x});let v=I(l),y={tokenIndex:s.tokenIndex,offset:s.offset},E=N(v,y);return{buffer:{tokens:v,caret:E},inverse:{type:"insertTokens",at:s,tokens:h}}}if(e.type==="replaceToken"){let{index:s,token:a}=e,l=[...n],u=l[s];l[s]=a;let m=I(l),o=N(m,r);return{buffer:{tokens:m,caret:o},inverse:{type:"replaceToken",index:s,token:u}}}if(e.type==="insertTokens"){let{at:s,tokens:a}=e,l=[...n],u=l[s.tokenIndex];if(u.type!=="text")throw new Error("Cannot insert tokens into non-text token");let m=u.value.slice(0,s.offset),o=u.value.slice(s.offset),i=[...a];if(i.length>0){let c=i[0];c.type==="text"?i[0]={type:"text",value:m+c.value}:m&&i.unshift({type:"text",value:m});let d=i[i.length-1];d.type==="text"?i[i.length-1]={type:"text",value:d.value+o}:o&&i.push({type:"text",value:o})}else i.push({type:"text",value:m+o});l.splice(s.tokenIndex,1,...i);let f=I(l),p=a[a.length-1],x=0,h=0;if(p&&p.type!=="text"){let c=0;for(let T=0;T<s.tokenIndex;T++){let S=n[T];S.type==="text"&&(c+=S.value.length)}c+=s.offset;let d=c;for(let T of a)T.type==="text"&&(d+=T.value.length);let g=0;for(let T of a)T.type!=="text"&&g++;let k=0,w=0,O=!1;for(let T=0;T<f.length;T++){let S=f[T];if(S.type==="text"){if(!O&&k>=c&&(O=!0),d<=k+S.value.length){x=T,h=d-k;break}k+=S.value.length}else if(O&&(w++,w===g)){x=T+1,h=0;break}}}else{let c=m.length;for(let g of a)g.type==="text"&&(c+=g.value.length);let d=0;for(let g=0;g<f.length;g++){let k=f[g];if(k.type==="text"){if(c<=d+k.value.length){x=g,h=c-d;break}d+=k.value.length}}}let y=N(f,{tokenIndex:x,offset:h});return{buffer:{tokens:f,caret:y},inverse:{type:"deleteRange",from:s,to:y}}}throw new Error(`Unknown op type: ${e.type}`)}function b(t){let e=document.createElement("div");return e.textContent=t||"",e.textContent||""}function R(t,e){e.textContent="";let n=new Map,r=0;for(let s=0;s<t.length;s++){let a=t[s];if(a.type==="lens"){let l=document.createElement("span");l.setAttribute("x-data",`lensToken('${a.lensId}', '${a.atName}')`),l.setAttribute("x-on:click","removeLens()"),l.setAttribute("data-token","lens"),e.appendChild(l),n.set(s,{node:l,textStart:r,textEnd:r})}else if(a.type==="text"){let l=document.createTextNode(b(a.value));e.appendChild(l),n.set(s,{node:l,textStart:r,textEnd:r+a.value.length}),r+=a.value.length}}return n}function q(t,e,n){let r=e.get(t.tokenIndex);if(!r)return null;if(r.node.nodeType===Node.TEXT_NODE)return{node:r.node,offset:t.offset};if(t.offset===0)return{node:n,offset:Array.from(n.childNodes).indexOf(r.node)};let s=t.tokenIndex+1,a=e.get(s);return a?{node:n,offset:Array.from(n.childNodes).indexOf(a.node)}:{node:n,offset:n.childNodes.length}}function C(t,e,n,r){for(let[s,a]of n.entries())if(a.node===t)return t.nodeType===Node.TEXT_NODE?{tokenIndex:s,offset:Math.min(e,a.textEnd-a.textStart)}:{tokenIndex:s,offset:0};if(t===r){let s=Array.from(r.childNodes);if(e>=s.length){let l=n.size-1,u=n.get(l);return u&&u.node.nodeType===Node.TEXT_NODE?{tokenIndex:l,offset:u.textEnd-u.textStart}:{tokenIndex:l,offset:0}}let a=s[e];for(let[l,u]of n.entries())if(u.node===a)return{tokenIndex:l,offset:0}}return{tokenIndex:n.size-1,offset:0}}var J=/(?:^|[^A-Za-z0-9-])@([A-Za-z0-9-]*)/g;function j(t,e){let n="",r=[],s=0,a=-1;for(let p=0;p<t.length;p++){let x=t[p];if(x.type==="text"){let h=n.length;n+=x.value,r.push({tokenIndex:p,startChar:h,endChar:n.length}),p<e.tokenIndex?s+=x.value.length:p===e.tokenIndex&&(s+=e.offset,a=r.length-1)}else r.push({tokenIndex:p,startChar:n.length,endChar:n.length}),p<e.tokenIndex&&(a=r.length-1)}if(a===-1||n.length===0)return null;let l=n.slice(0,s),u=Array.from(l.matchAll(J));if(u.length===0)return null;let m=u[u.length-1],o=m[0].startsWith("@")?0:1,i=m.index+o,f=i+m[0].length-o;if(f!==s)return null;for(let p of r)if(i>=p.startChar&&i<p.endChar)return f>p.endChar?null:{tokenIndex:p.tokenIndex,startOffset:i-p.startChar,endOffset:f-p.startChar,query:m[1].toLowerCase(),raw:m[0].slice(o)};return null}function L(t){let e=t,n={tokens:A(""),caret:{tokenIndex:0,offset:0}},r=null,s=!1,a=()=>{if(!e||!r||document.activeElement!==e)return;let o=q(n.caret,r,e);if(!o)return;let i=window.getSelection();if(!i)return;let f=document.createRange();f.setStart(o.node,o.offset),f.collapse(!0),i.removeAllRanges(),i.addRange(f)},l=()=>{if(!e||!r)return;let o=window.getSelection();if(!o||!o.rangeCount)return;let i=o.getRangeAt(0);n.caret=C(i.startContainer,i.startOffset,r,e)},u=()=>{if(!e)return;let o=[],i=new Map,f=0,p=0,x=!1;for(let c of e.childNodes){if(c.nodeType===Node.ELEMENT_NODE&&c.dataset?.token==="lens"){o.push({type:"lens",lensId:c.dataset.lensId,atName:c.dataset.atName}),i.set(p++,{node:c,textStart:f,textEnd:f});continue}if(c.nodeType===Node.TEXT_NODE){let d=c.textContent||"";o.push({type:"text",value:d}),i.set(p++,{node:c,textStart:f,textEnd:f+d.length}),f+=d.length;continue}c.nodeType===Node.ELEMENT_NODE&&c.tagName==="BR"&&(x=!0)}let h=o.some((c,d)=>c.type==="text"&&d>0&&o[d-1].type==="text"),v=o.length>0&&o[o.length-1].type==="lens";(h||v||x)&&(x=!0);let y=n.caret,E=window.getSelection();if(E&&E.rangeCount){let c=E.getRangeAt(0);y=C(c.startContainer,c.startOffset,i,e)}if(x){let c=I(o);y=N(c,y),n={tokens:c,caret:y},m()}else{let c=I(o);y=N(c,y),n={tokens:c,caret:y},r=i}},m=()=>{if(!(!e||s)){s=!0;try{r=R(n.tokens,e),a(),window.Alpine&&window.Alpine.initTree(e)}finally{s=!1}}};return{getBuffer(){return n},setBuffer(o){n=o,m()},loadFromQuery(o,i){let f=[];i?.lensId&&i?.atName&&f.push({lensId:i.lensId,atName:i.atName});let p=A(o,f),x=p.length-1,h=p[x];n={tokens:p,caret:{tokenIndex:x,offset:h?.type==="text"?h.value.length:0}},m()},syncFromDOM(){u()},syncBufferOnly(){if(!e)return;let o=[],i=new Map,f=0,p=0;for(let c of e.childNodes)if(c.nodeType===Node.ELEMENT_NODE&&c.dataset?.token==="lens")o.push({type:"lens",lensId:c.dataset.lensId,atName:c.dataset.atName}),i.set(p++,{node:c,textStart:f,textEnd:f});else if(c.nodeType===Node.TEXT_NODE){let d=c.textContent||"";o.push({type:"text",value:d}),i.set(p++,{node:c,textStart:f,textEnd:f+d.length}),f+=d.length}o.length===0&&(o.push({type:"text",value:""}),i.set(0,{node:null,textStart:0,textEnd:0}));let x=window.getSelection(),h={tokenIndex:0,offset:0};if(x&&x.rangeCount){let c=x.getRangeAt(0);h=C(c.startContainer,c.startOffset,i,e)}let v=o.length-1;h.tokenIndex=Math.max(0,Math.min(h.tokenIndex,v));let y=o[h.tokenIndex],E=y?.type==="text"?y.value.length:0;h.offset=Math.max(0,Math.min(h.offset,E)),n={tokens:o,caret:h},r=i},serialize(){return P(n.tokens)},detectMention(){return j(n.tokens,n.caret)},insertLensToken(o,i,f){if(!e)return;let p=window.getSelection();if(!p||!p.rangeCount)return;let x=r.get(o.tokenIndex);if(!x||!x.node)return;let h=x.node,v=h.textContent||"",y=v.slice(0,o.startOffset),E=v.slice(o.endOffset),c=document.createElement("span");c.setAttribute("x-data",`lensToken('${i}', '${f}')`),c.setAttribute("x-on:click","removeLens()"),c.setAttribute("data-token","lens");let d=h.parentNode;if(!d)return;if(y){let w=document.createTextNode(y);d.insertBefore(w,h)}if(d.insertBefore(c,h),E){let w=document.createTextNode(E);d.insertBefore(w,h)}else{let w=document.createTextNode(" ");d.insertBefore(w,h)}d.removeChild(h),window.Alpine&&window.Alpine.initTree(c);let g=document.createRange(),k=c.nextSibling;k&&k.nodeType===Node.TEXT_NODE&&(g.setStart(k,0),g.collapse(!0),p.removeAllRanges(),p.addRange(g)),this.syncBufferOnly()},applyOperation(o){l();let i=_(n,o);return n=i.buffer,m(),i.inverse},removeLens(o){if(!e)return;let i=e.querySelector(`[data-token="lens"][data-lens-id="${o}"]`);!i||!i.parentNode||(i.parentNode.removeChild(i),this.syncBufferOnly())},placeCaretAtEnd(){if(!e)return;let o=window.getSelection();if(!o)return;let i=e.lastChild;if(!i)return;let f=document.createRange();i.nodeType===Node.TEXT_NODE?f.setStart(i,i.textContent?.length||0):f.setStartAfter(i),f.collapse(!0),o.removeAllRanges(),o.addRange(f),this.syncBufferOnly()},onInput(o){e&&e.addEventListener("input",()=>{l(),o()})},destroy(){r=null}}}var z=()=>({queryValue:"",settingsOpen:!1,submitting:!1,mentionOpen:!1,mentionIndex:0,mentionQuery:"",mentionOptions:[],lensOptions:[],idToAtName:{},errorMessage:"",controller:null,showError(t){this.errorMessage=t,setTimeout(()=>this.errorMessage="",5e3)},init(){let t=this.$store.search.query||"",e=this.$store.search.lens_map||{};this.queryValue=t.replace(/^@\S+\s*/,""),this.buildLensState(e),this.controller=L(this.$refs?.editor),this.$watch("queryValue",n=>{this.$store.search.query=n}),this.$watch("$store.search.lens_id",(n,r)=>{let s=this.$refs?.lensSelect;s&&(s.value=n),r!==void 0&&this.controller.removeLens(r),this.syncFromStore(),r!==void 0&&this.controller&&document.activeElement===this.$refs?.editor&&this.controller.placeCaretAtEnd()}),this.$nextTick(()=>{this.syncFromStore(),t||this.$refs?.editor?.focus()})},syncFromStore(){if(!this.controller)return;this.controller.loadFromQuery(this.queryValue,this.getSelectedLens());let t=this.$refs?.textarea;t&&(t.value=this.queryValue)},syncToStore(){if(!this.controller)throw new Error("Buffer controller not initialized");this.controller.syncBufferOnly();let t=this.controller.serialize();if(t!==this.queryValue){this.queryValue=t;let e=this.$refs?.textarea;e&&(e.value=t)}this.updateMentionState()},updateMentionState(){if(!this.controller)return;let t=this.controller.detectMention();if(!t){this.mentionOpen=!1,this.mentionQuery="",this.mentionOptions=this.lensOptions,this.mentionIndex=0;return}let e=t.query,n=this.lensOptions.filter(s=>s.atName.startsWith(e)),r=this.mentionOpen&&this.mentionQuery===e;this.mentionOpen=n.length>0,this.mentionQuery=e,this.mentionOptions=n,this.mentionIndex=r?Math.min(this.mentionIndex,Math.max(n.length-1,0)):0},buildLensState(t){let e=Object.entries(t).map(([r,s])=>({lensId:s,atName:r.toLowerCase()})).filter(r=>r.atName),n=Object.fromEntries(Object.entries(t).map(([r,s])=>[s,r]));this.lensOptions=e,this.mentionOptions=e,this.idToAtName=n},getSelectedLens(){let t=this.$store.search.lens_id||"";if(!t)return null;let e=this.idToAtName[t]||"";return{lensId:t,atName:e}},selectMention(){if(!this.controller||!this.mentionOpen||!this.mentionOptions.length)return;let t=this.controller.detectMention();if(!t)return;let e=this.mentionOptions[this.mentionIndex];e&&(this.controller.insertLensToken(t,e.lensId,e.atName),this.$store.search.lens_id=e.lensId,this.queryValue=this.controller.serialize(),this.mentionOpen=!1,this.mentionQuery="",this.mentionOptions=this.lensOptions,this.mentionIndex=0)},handleEditorKeydown(t){if(!this.mentionOpen){t.key==="Enter"&&(t.preventDefault(),this.submit());return}if(t.key==="ArrowDown"){t.preventDefault();let e=Math.max(this.mentionOptions.length-1,0);this.mentionIndex=Math.min(this.mentionIndex+1,e);return}if(t.key==="ArrowUp"){t.preventDefault(),this.mentionIndex=Math.max(this.mentionIndex-1,0);return}if(t.key==="Enter"||t.key===" "){t.preventDefault(),this.selectMention();return}t.key==="Escape"&&(t.preventDefault(),this.mentionOpen=!1,this.mentionQuery="",this.mentionOptions=this.lensOptions,this.mentionIndex=0)},async submit(){if(this.submitting)return;let t=this.$refs?.form;if(!t)throw new Error("Form ref not found");this.submitting=!0;try{let n=this.$refs?.lensSelect?.value?.trim()||this.$store.search.lens_id||"",r=this.queryValue.trim(),s=Number(this.$store.search.limit);if(!s||s<1)throw new Error("Invalid search limit");let a={q:r,exact:!!this.$store.search.exact,limit:s,lens_id:n||void 0},l=await fetch("/v1/search/fragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok)throw new Error(`Search failed (HTTP ${l.status})`);let u=await l.text(),m=document.querySelector("#search-root");if(!m)throw new Error("Page missing #search-root element");m.outerHTML=u;let o=new URLSearchParams;a.q&&o.set("q",a.q),a.exact&&o.set("exact","true"),a.limit&&o.set("limit",String(a.limit)),a.lens_id&&o.set("lens_id",a.lens_id);let i=o.toString()?`${t.action}?${o.toString()}`:t.action;window.history.replaceState({},"",i)}catch(e){let n=e instanceof Error?e.message:String(e);this.showError(`Search failed: ${n}`)}finally{this.submitting=!1}}});var B=(t,e)=>({lensId:t,rawAtName:e,init(){if(!this.lensId||!this.rawAtName)throw new Error("lensId and rawAtName are required");this.render()},render(){let n=this.$el,r=b(this.rawAtName.toLowerCase());n.className="query-token",n.dataset.token="lens",n.dataset.lensId=this.lensId,n.dataset.atName=r,n.textContent=`@${r}`,n.setAttribute("contenteditable","false"),n.style.cursor="pointer"},removeLens(){this.$store.search.clearLens()}});var D=()=>({pending:!1,assistantEventSource:null,jobPollTimeout:null,jobPollAttempt:0,createPlaceholder(t){let e=this.$refs.placeholderTemplate.content.cloneNode(!0),n=e.querySelector(".message");return n.dataset.tempId=t,e},parseHtmlElement(t){let e=document.createElement("template");return e.innerHTML=String(t).trim(),e.content.firstElementChild},cleanupAssistantStream(){this.assistantEventSource&&this.assistantEventSource.close(),this.assistantEventSource=null},cleanupJobPoll(){this.jobPollTimeout&&clearTimeout(this.jobPollTimeout),this.jobPollTimeout=null,this.jobPollAttempt=0},async pollJobStatus(t,e){try{let n=await fetch(`/v1/threads/${t}/activity`,{headers:{Accept:"application/json"}});if(!n.ok)return;if((await n.json())?.job_events?.[0]?.status==="failed"){let l=this.$refs.responses.querySelector(`[data-temp-id="${e}"]`);l&&l.remove(),this.cleanupJobPoll();return}this.jobPollAttempt+=1;let a=Math.min(1e3*Math.pow(2,this.jobPollAttempt),3e4);this.jobPollTimeout=setTimeout(()=>this.pollJobStatus(t,e),a)}catch(n){console.error("Error polling job status:",n),this.jobPollAttempt+=1;let r=Math.min(1e3*Math.pow(2,this.jobPollAttempt),3e4);this.jobPollTimeout=setTimeout(()=>this.pollJobStatus(t,e),r)}},startEventStreams(t,e,{afterAssistantUuid:n=null}={}){if(this.assistantEventSource)return;let r=new URL(`/v1/threads/${t}/stream`,window.location.origin);r.searchParams.set("role","assistant"),n&&r.searchParams.set("after_uuid",n),this.assistantEventSource=new EventSource(r),this.assistantEventSource.addEventListener("assistant",async s=>{try{let l=JSON.parse(s?.data||"{}")?.uuid;if(!l)return;let u=await fetch(`/v1/messages/${l}/fragment`,{headers:{Accept:"text/html"}});if(!u.ok)return;let m=await u.text(),o=this.parseHtmlElement(m),i=this.$refs.responses.querySelector(`[data-temp-id="${e}"]`);i&&o&&i.replaceWith(o),this.cleanupJobPoll()}finally{this.cleanupAssistantStream()}}),this.assistantEventSource.addEventListener("error",()=>this.cleanupAssistantStream()),this.jobPollAttempt=0,this.pollJobStatus(t,e)},init(){if(!this.$refs.responses||this.$refs.responses.children.length)return;let t=this.$el?.dataset?.threadId;if(!t)return;let e="initial",n=this.createPlaceholder(e);this.$refs.responses.prepend(n),this.startEventStreams(t,e)},async regenerate(t){if(this.pending)return;let e=t?.currentTarget,n=e?.dataset?.threadId,r=e?.dataset?.model,s=e?.dataset?.promptContent;if(!n||!s)return;this.pending=!0;let a=Math.random().toString(36).slice(2,10),l=this.createPlaceholder(a);this.$refs.responses.prepend(l);try{let m=this.$refs.responses.querySelector(".message[data-uuid]")?.dataset?.uuid||null,o=await fetch("/v1/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:s,thread_id:n,lens_id:this.$refs?.lensSelect?.value||void 0,model:r})});if(!o.ok)throw new Error(`Ask HTTP ${o.status}`);this.startEventStreams(n,a,{afterAssistantUuid:m})}catch(u){console.error("Error:",u);let m=this.$refs.responses.querySelector(`[data-temp-id="${a}"]`);m&&m.remove()}finally{this.pending=!1}}});document.addEventListener("alpine:init",()=>{if(!window.TRANSPORT?.search)throw new Error("TRANSPORT.search not found");Alpine.store("search",{...window.TRANSPORT.search,clearLens(){this.lens_id=""}}),Alpine.data("askButton",$),Alpine.data("responseMessage",M),Alpine.data("searchForm",z),Alpine.data("lensToken",B),Alpine.data("threadMessagesPage",D)});})();
