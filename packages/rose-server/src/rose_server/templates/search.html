{% extends "base.html" %}

{% block title %}Search: {{ query }}{% endblock %}

{% block extra_style %}
.result { margin: 20px 0; padding: 15px; border: 1px solid #333; }
.score { color: #666; font-size: 0.9em; }
.metadata { color: #888; font-size: 0.85em; margin-top: 10px; }
.content { margin: 10px 0; white-space: pre-wrap; }
input[type="text"] { font-family: monospace; padding: 5px; width: 400px; }
input[type="submit"] { font-family: monospace; padding: 5px 15px; }
{% endblock %}

{% block content %}
<form action="/v1/search" method="get">
    <input type="text" name="q" value="{{ query }}" autofocus>
    <input type="submit" value="Search">
</form>
<p>Results: {{ hits|length }}</p>

{% for hit in hits %}
<a href="/v1/threads/{{ hit.metadata.get('thread_id') }}#msg-{{ hit.id }}">
    <div class="result">
        <div class="score">Score: {{ "%.4f"|format(hit.score) }}</div>
        <div class="content">{{ hit.excerpt }}</div>
        <div class="metadata">
            Thread: {{ hit.metadata.get('thread_id', 'N/A') }} |
            Role: {{ hit.metadata.get('role', 'N/A') }} |
            Created: {{ hit.metadata.get('created_at', 'N/A') }}
        </div>
    </div>
</a>
{% endfor %}
{% endblock %}
