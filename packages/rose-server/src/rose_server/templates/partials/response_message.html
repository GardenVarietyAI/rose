{% set accept_label = 'accepted' if response_accepted else 'accept answer' %}
<div
  class="message{% if response_accepted %} accepted{% endif %}"
  {% if response_dom_id %}id="{{ response_dom_id }}"{% endif %}
  data-uuid="{{ response_uuid }}"
  x-data="{
    uuid: $el.dataset.uuid,
    accepted: $el.classList.contains('accepted'),
    async toggleAccepted() {
      try {
        const response = await fetch(`/v1/messages/${this.uuid}`, {
          method: 'PATCH',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ accepted: !this.accepted }),
        });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        this.accepted = !this.accepted;
      } catch (error) {
        console.error('Error:', error);
      }
    },
  }"
  :class="{ accepted }"
>
  <div class="message-header">
    <span class="message-role">{{ response_role }}</span>
    {% if response_model %}<span class="message-model"> | {{ response_model }}</span>{% endif %}
    | <a
      href="#"
      class="accept-link"
      :class="{ accepted }"
      x-text="accepted ? 'accepted' : 'accept answer'"
      @click.prevent="toggleAccepted()"
    >{{ accept_label }}</a>
  </div>
  <div class="message-content">{{ response_content }}</div>
  <div class="message-meta">{{ response_created_at }}</div>
</div>
